<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEO Text Optimizer - Optimize Content for Search Engines</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        @font-face { font-family: 'Futura'; src: local('Futura Extra Bold'); font-weight: 800; font-style: italic; }
        
        :root {
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --text-primary: #000000;
            --text-secondary: #4a4a4a;
            --text-muted: #717171;
            --accent-primary: #1292eb;
            --accent-hover: #0d7fd4;
            --accent-light: rgba(18,146,235,0.1);
            --border-color: #e5e5e5;
            --success-color: #10b981;
            --success-light: rgba(16,185,129,0.1);
            --warning-color: #f59e0b;
            --warning-light: rgba(245,158,11,0.1);
            --error-color: #ef4444;
            --error-light: rgba(239,68,68,0.1);
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; line-height: 1.6; }
        .container { max-width: 1200px; margin: 0 auto; padding: 60px 24px 80px; }

        .header { text-align: center; margin-bottom: 40px; }
        .header-icon { display: inline-flex; align-items: center; justify-content: center; width: 72px; height: 72px; background: var(--accent-light); border-radius: var(--radius-lg); font-size: 36px; margin-bottom: 20px; }
        .header h1 { font-family: 'Futura', 'Trebuchet MS', sans-serif; font-size: clamp(32px, 5vw, 48px); font-weight: 800; font-style: italic; margin-bottom: 12px; }
        .header h1 span { color: var(--accent-primary); }
        .header p { font-size: 17px; color: var(--text-secondary); max-width: 600px; margin: 0 auto; }

        .stats-bar { display: flex; justify-content: center; gap: 40px; margin-bottom: 40px; padding: 16px; background: var(--bg-secondary); border-radius: var(--radius-lg); flex-wrap: wrap; }
        .stat { display: flex; align-items: center; gap: 8px; font-size: 14px; color: var(--text-secondary); }
        .stat-icon { width: 32px; height: 32px; background: var(--accent-light); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: var(--accent-primary); }
        .stat strong { color: var(--text-primary); }

        .main-layout { display: grid; grid-template-columns: 1fr 380px; gap: 24px; }

        .input-panel { background: var(--bg-primary); border: 2px solid var(--border-color); border-radius: var(--radius-lg); overflow: hidden; transition: border-color 0.3s; }
        .input-panel:focus-within { border-color: var(--accent-primary); }
        .panel-header { display: flex; align-items: center; justify-content: space-between; padding: 16px 20px; background: var(--bg-secondary); border-bottom: 1px solid var(--border-color); }
        .panel-title { display: flex; align-items: center; gap: 10px; font-size: 14px; font-weight: 600; }
        .panel-title-icon { display: flex; align-items: center; justify-content: center; width: 28px; height: 28px; background: var(--accent-light); border-radius: 6px; font-size: 14px; }
        .word-count { font-size: 13px; color: var(--text-muted); font-weight: 500; }
        .panel-body { padding: 20px; }
        textarea { width: 100%; min-height: 300px; border: none; outline: none; resize: vertical; font-family: inherit; font-size: 15px; line-height: 1.7; color: var(--text-primary); background: transparent; }
        textarea::placeholder { color: var(--text-muted); }

        .keyword-section { padding: 16px 20px; border-top: 1px solid var(--border-color); background: var(--bg-secondary); }
        .keyword-label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 10px; }
        .keyword-input { width: 100%; padding: 12px 16px; border: 2px solid var(--border-color); border-radius: var(--radius-md); font-family: inherit; font-size: 14px; color: var(--text-primary); background: var(--bg-primary); transition: border-color 0.3s; }
        .keyword-input:focus { outline: none; border-color: var(--accent-primary); }
        .keyword-input::placeholder { color: var(--text-muted); }

        .analysis-panel { display: flex; flex-direction: column; gap: 16px; }

        .score-card { background: var(--bg-primary); border: 2px solid var(--border-color); border-radius: var(--radius-lg); padding: 24px; text-align: center; }
        .score-circle { position: relative; width: 120px; height: 120px; margin: 0 auto 16px; }
        .score-circle svg { transform: rotate(-90deg); }
        .score-circle-bg { fill: none; stroke: var(--border-color); stroke-width: 8; }
        .score-circle-progress { fill: none; stroke: var(--accent-primary); stroke-width: 8; stroke-linecap: round; stroke-dasharray: 339.292; stroke-dashoffset: 339.292; transition: stroke-dashoffset 1s ease-out, stroke 0.3s ease; }
        .score-circle-progress.good { stroke: var(--success-color); }
        .score-circle-progress.medium { stroke: var(--warning-color); }
        .score-circle-progress.poor { stroke: var(--error-color); }
        .score-value { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 32px; font-weight: 800; }
        .score-label { font-size: 14px; font-weight: 600; color: var(--text-secondary); margin-bottom: 4px; }
        .score-description { font-size: 13px; color: var(--text-muted); }

        .metrics-card { background: var(--bg-primary); border: 2px solid var(--border-color); border-radius: var(--radius-lg); padding: 20px; }
        .metrics-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; }
        .metric-item { display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid var(--border-color); }
        .metric-item:last-child { border-bottom: none; }
        .metric-label { font-size: 13px; color: var(--text-secondary); }
        .metric-badge { padding: 4px 10px; border-radius: 100px; font-size: 12px; font-weight: 600; }
        .metric-badge.good { background: var(--success-light); color: var(--success-color); }
        .metric-badge.medium { background: var(--warning-light); color: var(--warning-color); }
        .metric-badge.poor { background: var(--error-light); color: var(--error-color); }

        .suggestions-card { background: var(--bg-primary); border: 2px solid var(--border-color); border-radius: var(--radius-lg); padding: 20px; }
        .suggestions-title { font-size: 14px; font-weight: 600; margin-bottom: 16px; }
        .suggestion-item { display: flex; gap: 12px; padding: 12px; background: var(--bg-secondary); border-radius: var(--radius-md); margin-bottom: 10px; }
        .suggestion-item:last-child { margin-bottom: 0; }
        .suggestion-icon { flex-shrink: 0; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center; border-radius: 50%; font-size: 12px; }
        .suggestion-icon.success { background: var(--success-light); color: var(--success-color); }
        .suggestion-icon.warning { background: var(--warning-light); color: var(--warning-color); }
        .suggestion-icon.error { background: var(--error-light); color: var(--error-color); }
        .suggestion-text { font-size: 13px; color: var(--text-secondary); line-height: 1.5; }

        .placeholder-state { text-align: center; padding: 40px 20px; color: var(--text-muted); }
        .placeholder-state .icon { font-size: 48px; margin-bottom: 16px; opacity: 0.5; }
        .placeholder-state h3 { font-size: 16px; font-weight: 600; color: var(--text-secondary); margin-bottom: 8px; }

        .generate-section { margin-top: 24px; }
        .generate-btn { width: 100%; display: flex; align-items: center; justify-content: center; gap: 10px; padding: 16px 32px; background: var(--accent-primary); border: none; border-radius: var(--radius-lg); font-size: 15px; font-weight: 600; color: white; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 20px rgba(18,146,235,0.3); }
        .generate-btn:hover { background: var(--accent-hover); transform: translateY(-2px); }
        .generate-btn:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
        .spinner { width: 18px; height: 18px; border: 2px solid rgba(255,255,255,0.3); border-top-color: white; border-radius: 50%; animation: spin 0.8s linear infinite; display: none; }
        .generate-btn.loading .spinner { display: block; }
        .generate-btn.loading .btn-text { display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .loading-message { text-align: center; padding: 40px 20px; display: none; }
        .loading-message.show { display: block; }
        .loading-message h3 { font-size: 18px; margin-bottom: 8px; }
        .loading-message p { color: var(--text-muted); font-size: 14px; }
        .loading-dots { display: flex; justify-content: center; gap: 8px; margin-bottom: 16px; }
        .loading-dots span { font-size: 24px; animation: pulse 1.5s ease-in-out infinite; }
        .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
        .loading-dots span:nth-child(3) { animation-delay: 0.4s; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

        .error-message { background: var(--error-light); border: 2px solid #fecaca; color: var(--error-color); padding: 16px 20px; border-radius: var(--radius-md); margin-bottom: 20px; display: none; }
        .error-message.show { display: block; }

        .output-section { display: none; margin-top: 32px; }
        .output-section.show { display: block; animation: slideUp 0.4s ease-out; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; } }

        .output-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; }
        .output-card { background: var(--bg-primary); border: 2px solid var(--border-color); border-radius: var(--radius-lg); padding: 20px; }
        .output-card.full-width { grid-column: 1 / -1; }
        .output-card-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
        .output-card-title { display: flex; align-items: center; gap: 8px; font-size: 14px; font-weight: 600; }
        .copy-btn { display: flex; align-items: center; justify-content: center; width: 32px; height: 32px; background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-muted); cursor: pointer; transition: all 0.2s; }
        .copy-btn:hover { border-color: var(--accent-primary); color: var(--accent-primary); }
        .copy-btn.copied { border-color: var(--success-color); color: var(--success-color); background: var(--success-light); }
        .output-content { font-size: 14px; line-height: 1.6; color: var(--text-secondary); }
        .keyword-tags { display: flex; flex-wrap: wrap; gap: 8px; }
        .keyword-tag { padding: 6px 14px; background: var(--accent-light); border-radius: 100px; font-size: 13px; font-weight: 500; color: var(--accent-primary); }

        .reset-btn { display: flex; align-items: center; justify-content: center; gap: 8px; margin: 24px auto 0; padding: 12px 24px; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: var(--radius-md); font-size: 14px; font-weight: 600; color: var(--text-secondary); cursor: pointer; transition: all 0.25s; }
        .reset-btn:hover { border-color: var(--accent-primary); color: var(--accent-primary); }

        @media (max-width: 900px) {
            .main-layout { grid-template-columns: 1fr; }
            .output-grid { grid-template-columns: 1fr; }
            .stats-bar { flex-direction: column; align-items: center; }
        }
    </style>
</head>
<body>
<div class="container">
    <header class="header">
        <div class="header-icon">üîç</div>
        <h1>SEO Text <span>Optimizer</span></h1>
        <p>Optimize any text for search engines. Get AI-powered meta tags, keyword suggestions, and fully rewritten SEO-optimized content.</p>
    </header>

    <div class="stats-bar">
        <div class="stat"><div class="stat-icon">ü§ñ</div><span><strong>AI</strong> powered</span></div>
        <div class="stat"><div class="stat-icon">üéØ</div><span><strong>SEO</strong> optimized</span></div>
        <div class="stat"><div class="stat-icon">‚ö°</div><span><strong>Instant</strong> results</span></div>
    </div>

    <div id="formSection">
        <div class="main-layout">
            <div class="input-panel">
                <div class="panel-header">
                    <div class="panel-title">
                        <div class="panel-title-icon">üìù</div>
                        Your Content
                    </div>
                    <span class="word-count"><span id="wordCount">0</span> words</span>
                </div>
                <div class="panel-body">
                    <textarea id="contentInput" placeholder="Paste your content here to analyze and optimize for SEO...

Example: 'Our new eco-friendly water bottles are made from 100% recycled materials. Each bottle helps reduce plastic waste in our oceans while keeping your drinks cold for up to 24 hours...'"></textarea>
                </div>
                <div class="keyword-section">
                    <label class="keyword-label">üéØ Target Keyword (optional)</label>
                    <input type="text" class="keyword-input" id="keywordInput" placeholder="e.g., eco-friendly water bottle">
                </div>
            </div>

            <div class="analysis-panel">
                <div class="score-card">
                    <div class="score-circle">
                        <svg width="120" height="120" viewBox="0 0 120 120">
                            <circle class="score-circle-bg" cx="60" cy="60" r="54"/>
                            <circle class="score-circle-progress" id="scoreProgress" cx="60" cy="60" r="54"/>
                        </svg>
                        <div class="score-value" id="scoreValue">--</div>
                    </div>
                    <div class="score-label">SEO Score</div>
                    <div class="score-description" id="scoreDescription">Enter content to analyze</div>
                </div>

                <div class="metrics-card">
                    <div class="metrics-title">üìä Key Metrics</div>
                    <div class="metric-item">
                        <span class="metric-label">Readability</span>
                        <span class="metric-badge" id="readabilityBadge">--</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Keyword Density</span>
                        <span class="metric-badge" id="densityBadge">--</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Content Length</span>
                        <span class="metric-badge" id="lengthBadge">--</span>
                    </div>
                    <div class="metric-item">
                        <span class="metric-label">Sentence Length</span>
                        <span class="metric-badge" id="sentenceBadge">--</span>
                    </div>
                </div>

                <div class="suggestions-card">
                    <div class="suggestions-title">üí° Suggestions</div>
                    <div id="suggestionsList">
                        <div class="placeholder-state">
                            <div class="icon">üìã</div>
                            <h3>No analysis yet</h3>
                            <p>Click "Analyze & Optimize" to get suggestions</p>
                        </div>
                    </div>
                </div>

                <div class="generate-section">
                    <button class="generate-btn" id="analyzeBtn">
                        <span class="btn-text">üîç Analyze & Optimize</span>
                        <div class="spinner"></div>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="error-message" id="errorMessage"></div>

    <div class="loading-message" id="loadingMessage">
        <div class="loading-dots">
            <span>üîç</span>
            <span>üìù</span>
            <span>‚ú®</span>
        </div>
        <h3>Optimizing your content...</h3>
        <p>AI is analyzing and rewriting for SEO. This takes 10-20 seconds.</p>
    </div>

    <div class="output-section" id="outputSection">
        <div class="output-grid">
            <div class="output-card">
                <div class="output-card-header">
                    <div class="output-card-title">
                        <span>üìå</span>
                        Meta Title
                    </div>
                    <button class="copy-btn" data-copy="metaTitle">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="metaTitle"></div>
            </div>

            <div class="output-card">
                <div class="output-card-header">
                    <div class="output-card-title">
                        <span>üìù</span>
                        Meta Description
                    </div>
                    <button class="copy-btn" data-copy="metaDescription">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="metaDescription"></div>
            </div>

            <div class="output-card full-width">
                <div class="output-card-header">
                    <div class="output-card-title">
                        <span>üè∑Ô∏è</span>
                        Suggested Keywords
                    </div>
                </div>
                <div class="keyword-tags" id="suggestedKeywords"></div>
            </div>

            <div class="output-card full-width">
                <div class="output-card-header">
                    <div class="output-card-title">
                        <span>‚ú®</span>
                        SEO-Optimized Content
                    </div>
                    <button class="copy-btn" data-copy="optimizedContent">
                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"/>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/>
                        </svg>
                    </button>
                </div>
                <div class="output-content" id="optimizedContent" style="white-space: pre-wrap;"></div>
            </div>
        </div>
        <button class="reset-btn" id="resetBtn">‚Üê Optimize Another Text</button>
    </div>
</div>

<script>
const SYSTEM_PROMPT = `You are an expert SEO content optimizer. Your job is to analyze content and rewrite it for maximum search engine visibility while maintaining readability and natural flow.

When optimizing content:
1. Naturally incorporate the target keyword in the first paragraph, headings, and throughout
2. Use proper sentence structure and punctuation
3. Write in an engaging, readable style
4. Include semantic variations of the keyword
5. Structure with clear paragraphs
6. Aim for 1-2% keyword density (natural, not stuffed)`;

// DOM Elements
const contentInput = document.getElementById('contentInput');
const keywordInput = document.getElementById('keywordInput');
const wordCountEl = document.getElementById('wordCount');
const analyzeBtn = document.getElementById('analyzeBtn');

// Word count
contentInput.addEventListener('input', () => {
    const words = contentInput.value.trim().split(/\s+/).filter(w => w.length > 0);
    wordCountEl.textContent = words.length;
});

// Analysis functions
function countWords(text) {
    return text.trim().split(/\s+/).filter(w => w.length > 0).length;
}

function countSentences(text) {
    return text.split(/[.!?]+/).filter(s => s.trim().length > 0).length;
}

function calculateReadability(text) {
    const words = countWords(text);
    const sentences = countSentences(text);
    const avgWordsPerSentence = words / Math.max(sentences, 1);
    
    if (avgWordsPerSentence <= 15) return { score: 'Easy', class: 'good' };
    if (avgWordsPerSentence <= 20) return { score: 'Medium', class: 'medium' };
    return { score: 'Hard', class: 'poor' };
}

function calculateKeywordDensity(text, keyword) {
    if (!keyword) return { score: 'N/A', class: 'medium', value: 0 };
    
    const words = countWords(text);
    const keywordLower = keyword.toLowerCase();
    const textLower = text.toLowerCase();
    const keywordCount = (textLower.match(new RegExp(keywordLower.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g')) || []).length;
    const density = (keywordCount / words) * 100;
    
    if (density >= 1 && density <= 2.5) return { score: `${density.toFixed(1)}%`, class: 'good', value: density };
    if (density > 0 && density < 1) return { score: `${density.toFixed(1)}%`, class: 'medium', value: density };
    if (density > 2.5) return { score: `${density.toFixed(1)}%`, class: 'poor', value: density };
    return { score: '0%', class: 'poor', value: 0 };
}

function evaluateLength(words) {
    if (words >= 300) return { score: 'Good', class: 'good' };
    if (words >= 150) return { score: 'Short', class: 'medium' };
    return { score: 'Too Short', class: 'poor' };
}

function evaluateSentenceLength(text) {
    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 0);
    const avgLength = sentences.reduce((sum, s) => sum + countWords(s), 0) / Math.max(sentences.length, 1);
    
    if (avgLength <= 20) return { score: `${avgLength.toFixed(0)} words`, class: 'good' };
    if (avgLength <= 25) return { score: `${avgLength.toFixed(0)} words`, class: 'medium' };
    return { score: `${avgLength.toFixed(0)} words`, class: 'poor' };
}

function generateSuggestions(text, keyword, metrics) {
    const suggestions = [];
    const words = countWords(text);
    
    if (words < 300) {
        suggestions.push({ type: 'warning', text: 'Add more content. Aim for at least 300 words for better SEO rankings.' });
    } else {
        suggestions.push({ type: 'success', text: 'Good content length! Your text has enough words for SEO.' });
    }
    
    if (keyword) {
        const density = metrics.density.value;
        if (density === 0) {
            suggestions.push({ type: 'error', text: `Target keyword "${keyword}" not found. The optimized version will include it naturally.` });
        } else if (density < 1) {
            suggestions.push({ type: 'warning', text: `Keyword density is low (${density.toFixed(1)}%). Optimized version will improve this.` });
        } else if (density > 2.5) {
            suggestions.push({ type: 'warning', text: `Keyword density too high (${density.toFixed(1)}%). Risk of keyword stuffing.` });
        } else {
            suggestions.push({ type: 'success', text: `Great keyword density (${density.toFixed(1)}%)! Well optimized.` });
        }
    } else {
        suggestions.push({ type: 'warning', text: 'Add a target keyword for better optimization results.' });
    }
    
    if (metrics.readability.class === 'poor') {
        suggestions.push({ type: 'warning', text: 'Sentences are too long. The optimized version will have better readability.' });
    }
    
    return suggestions;
}

function calculateOverallScore(metrics, text, keyword) {
    let score = 50;
    const words = countWords(text);
    
    if (words >= 300) score += 20;
    else if (words >= 150) score += 10;
    else if (words >= 50) score += 5;
    
    if (metrics.readability.class === 'good') score += 15;
    else if (metrics.readability.class === 'medium') score += 8;
    
    if (keyword && metrics.density.class === 'good') score += 15;
    else if (keyword && metrics.density.class === 'medium') score += 8;
    
    return Math.min(score, 100);
}

function updateScoreCircle(score) {
    const circumference = 2 * Math.PI * 54;
    const offset = circumference - (score / 100) * circumference;
    const progress = document.getElementById('scoreProgress');
    
    progress.style.strokeDashoffset = offset;
    progress.classList.remove('good', 'medium', 'poor');
    
    if (score >= 70) progress.classList.add('good');
    else if (score >= 50) progress.classList.add('medium');
    else progress.classList.add('poor');
}

// Main analyze function
analyzeBtn.addEventListener('click', async () => {
    const text = contentInput.value.trim();
    const keyword = keywordInput.value.trim();
    
    if (!text) {
        document.getElementById('errorMessage').textContent = 'Please enter some content to optimize.';
        document.getElementById('errorMessage').classList.add('show');
        return;
    }
    
    document.getElementById('errorMessage').classList.remove('show');
    
    analyzeBtn.classList.add('loading');
    analyzeBtn.disabled = true;
    document.getElementById('loadingMessage').classList.add('show');
    document.getElementById('outputSection').classList.remove('show');

    // Calculate metrics from original text
    const metrics = {
        readability: calculateReadability(text),
        density: calculateKeywordDensity(text, keyword),
        length: evaluateLength(countWords(text)),
        sentence: evaluateSentenceLength(text)
    };

    // Update metric badges
    document.getElementById('readabilityBadge').textContent = metrics.readability.score;
    document.getElementById('readabilityBadge').className = `metric-badge ${metrics.readability.class}`;
    document.getElementById('densityBadge').textContent = metrics.density.score;
    document.getElementById('densityBadge').className = `metric-badge ${metrics.density.class}`;
    document.getElementById('lengthBadge').textContent = metrics.length.score;
    document.getElementById('lengthBadge').className = `metric-badge ${metrics.length.class}`;
    document.getElementById('sentenceBadge').textContent = metrics.sentence.score;
    document.getElementById('sentenceBadge').className = `metric-badge ${metrics.sentence.class}`;

    // Update score
    const score = calculateOverallScore(metrics, text, keyword);
    document.getElementById('scoreValue').textContent = score;
    updateScoreCircle(score);
    
    if (score >= 70) {
        document.getElementById('scoreDescription').textContent = 'Great! Your content is well optimized';
    } else if (score >= 50) {
        document.getElementById('scoreDescription').textContent = 'Good start, but room for improvement';
    } else {
        document.getElementById('scoreDescription').textContent = 'Needs work. See optimized version below';
    }

    // Generate suggestions
    const suggestions = generateSuggestions(text, keyword, metrics);
    document.getElementById('suggestionsList').innerHTML = suggestions.map(s => `
        <div class="suggestion-item">
            <div class="suggestion-icon ${s.type === 'success' ? 'success' : s.type === 'warning' ? 'warning' : 'error'}">
                ${s.type === 'success' ? '‚úì' : s.type === 'warning' ? '!' : '‚úï'}
            </div>
            <div class="suggestion-text">${s.text}</div>
        </div>
    `).join('');

    // Call AI for optimization
    const truncatedText = text.length > 3000 ? text.substring(0, 3000) + '...' : text;
    
    const userPrompt = `Optimize this content for SEO. Return a JSON object with these exact keys:

CONTENT TO OPTIMIZE:
"${truncatedText}"

TARGET KEYWORD: ${keyword || 'none specified - identify the main topic'}

Return ONLY valid JSON with these keys:
{
  "metaTitle": "SEO-optimized title under 60 characters, include keyword near start",
  "metaDescription": "Compelling meta description 150-160 characters, include keyword, add call-to-action",
  "keywords": ["keyword1", "keyword2", "keyword3", "keyword4", "keyword5", "keyword6", "keyword7", "keyword8"],
  "optimizedContent": "Fully rewritten SEO-optimized version of the content. Use proper punctuation, natural keyword placement (1-2% density), engaging sentences, and clear structure. Maintain the original meaning but improve for search engines and readability."
}`;

    try {
        const response = await fetch('https://api.anthropic.com/v1/messages', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                model: 'claude-haiku-4-5-20251001',
                max_tokens: 2500,
                system: SYSTEM_PROMPT,
                messages: [{ role: 'user', content: userPrompt }]
            })
        });

        const data = await response.json();
        
        if (data.error) {
            throw new Error(data.error.message || 'API request failed');
        }

        let textContent = data.content
            ?.filter(block => block.type === 'text')
            ?.map(block => block.text)
            ?.join('') || '';

        // Clean and parse JSON
        textContent = textContent.replace(/```json\s*/g, '').replace(/```\s*/g, '').trim();
        const jsonMatch = textContent.match(/\{[\s\S]*\}/);
        
        if (!jsonMatch) {
            throw new Error('Invalid response format. Please try again.');
        }

        const result = JSON.parse(jsonMatch[0]);

        // Display results
        document.getElementById('metaTitle').textContent = result.metaTitle || '';
        document.getElementById('metaDescription').textContent = result.metaDescription || '';
        document.getElementById('optimizedContent').textContent = result.optimizedContent || '';
        
        const keywordsHtml = (result.keywords || []).map(k => `<span class="keyword-tag">${k}</span>`).join('');
        document.getElementById('suggestedKeywords').innerHTML = keywordsHtml;

        document.getElementById('outputSection').classList.add('show');
        document.getElementById('formSection').style.display = 'none';
        document.getElementById('outputSection').scrollIntoView({ behavior: 'smooth' });

    } catch (err) {
        console.error('Error:', err);
        document.getElementById('errorMessage').textContent = err.message || 'Failed to optimize content. Please try again.';
        document.getElementById('errorMessage').classList.add('show');
    } finally {
        analyzeBtn.classList.remove('loading');
        analyzeBtn.disabled = false;
        document.getElementById('loadingMessage').classList.remove('show');
    }
});

// Copy buttons
document.querySelectorAll('.copy-btn').forEach(btn => {
    btn.addEventListener('click', async () => {
        const targetId = btn.dataset.copy;
        const targetElement = document.getElementById(targetId);
        
        if (targetElement) {
            await navigator.clipboard.writeText(targetElement.textContent);
            btn.classList.add('copied');
            setTimeout(() => btn.classList.remove('copied'), 2000);
        }
    });
});

// Reset
document.getElementById('resetBtn').addEventListener('click', () => {
    document.getElementById('outputSection').classList.remove('show');
    document.getElementById('formSection').style.display = 'block';
    window.scrollTo({ top: 0, behavior: 'smooth' });
});
</script>
</body>
</html>
